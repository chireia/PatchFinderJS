window.mapa = [
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'r', 'r', 'p', 'r', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'r', 'r', 'p', 'r', 'p', 'r', 'p', 'p', '11', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'r', 'p', 'r', 'p', 'r', 'r', 'r', 'p', 'p', '12', 'p', 'p', 'p', 'p', 'p', 'p', '13', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'r', 'p', 'p', 'm', 'p', 'p', 'r', 'p', 'r', 'r', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'r', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'p', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'r', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'p', 'p', 'r', 'p', 'r', 'r', 'r', 'p', 'p', '10', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'r', 'r', 'r', 'p', 'p', '9', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'p', 'r', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'm', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'm', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'p', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', '8', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'r', 'p', 'm', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'r', 'r', 'p', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'r', 'p', '6', 'p', 'r', 'r', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'r', 'r', 'p', 'p', 'r', 'p', 'r', 'r', 'p', '7', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'r', 'r', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'r', 'r', 'p', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'p', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'm', 'p', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'r', 'p', 'r', 'p', '5', 'p', 'p', 'r', 'r', 'p', 'r', 'r', 'r', 'p', 'r', 'r', 'r', 'p', 'r', 'r', 'p', '4', 'p', 'r', 'p', 'r', 'r', 'p', 'r', 'p', 'r', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'r', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'r', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'r', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'r', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'r', 'r', 'p', 'p', 'p', 'r', 'p', 'm', 'p', 'r', 'p', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'r', 'r', 'r', 'p', 'r', 'p', 'r', 'p', 'p', 'r', 'p', 'r', 'r', 'p', '2', 'p', 'p', 'r', 'p', 'r', 'r', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'r', 'p', '3', 'p', 'r', 'p', 'r', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'r', 'p', 'p', 'r', 'r', 'p', 'p', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'r', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'r', 'r', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'r', 'p', 'p', 'r', 'p', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'r', 'r', 'r', 'p', 'r', 'p', 'p', 'r', 'p', 'p', 'r', 'r', 'r', 'p', 'r', 'p', '1', 'p', 'r', 'p', 'r', 'r', 'p', 'r', 'p', 'r', 'p', 'p', 'r', 'p', 'p', 'p', '0', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'm', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'p', 'r', 'p', 'p', 'p', 'p', 'p', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm'],
  ['m', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm', 'm']
]
const body = document.getElementsByTagName('body')[0]
const table = document.createElement('table')
const tbody = document.createElement('tbody')
for (let i = 0; i < window.mapa.length; i++) {
  const tr = document.createElement('tr')
  for (let j = 0; j < window.mapa[0].length; j++) {
    const td = document.createElement('td')
    td.setAttribute('id', `[${i},${j}]`)
    const classe = isFinite(window.mapa[i][j]) ? 'c' : window.mapa[i][j]
    td.setAttribute('class', classe)
    tr.appendChild(td)
  }
  tbody.appendChild(tr)
}
table.appendChild(tbody)
body.appendChild(table)

window.inicio = [37, 37]
window.fim = [4, 37]

// https://github.com/nolanlawson/tiny-queue
window.Queue = function Queue () {
  this.length = 0
}
window.Queue.prototype.push = function (item) {
  var node = {item: item}
  if (this.last) {
    this.last = this.last.next = node
  } else {
    this.last = this.first = node
  }
  this.length++
}
window.Queue.prototype.shift = function () {
  var node = this.first
  if (node) {
    this.first = node.next
    if (!(--this.length)) {
      this.last = undefined
    }
    return node.item
  }
}

window.proximos = function proximos ([i, j]) {
  const proximos = []
  let vz = window.mapa[i][j + 1]
  if (vz === 'p' || vz === 'r' || isFinite(vz)) {
    proximos.push([i, j + 1])
  }
  vz = window.mapa[i][j - 1]
  if (vz === 'p' || vz === 'r' || isFinite(vz)) {
    proximos.push([i, j - 1])
  }
  vz = window.mapa[i + 1][j]
  if (vz === 'p' || vz === 'r' || isFinite(vz)) {
    proximos.push([i + 1, j])
  }
  vz = window.mapa[i - 1][j]
  if (vz === 'p' || vz === 'r' || isFinite(vz)) {
    proximos.push([i - 1, j])
  }
  return proximos
}

window.tamanho = function tamanho ([i, j]) {
  const t = window.mapa[i][j]
  if (isFinite(t)) {
    return 0
  } else if (t === 'p') {
    return 1
  } else if (t === 'r') {
    return 5
  } else {
    return Infinity
  }
}

window.keyner = function keyner ([i, j]) {
  return `[${i},${j}]`
}
window.fila = new window.Queue()
window.fila.push(window.inicio)
window.caminhos = {}
window.caminhos[window.keyner(window.inicio)] = {
  distancia: 0,
  percurso: [window.inicio]
}
/*
window.t0 = Date.now()
while (window.fila.length > 0) {
  let noIJ = window.fila.shift()
  let no = window.caminhos[window.keyner(noIJ)]
  for (const p of window.proximos(noIJ)) {
    const strp = window.keyner(p)
    const tamp = window.tamanho(p)
    if (Object.keys(window.caminhos).includes(strp)) {
      if (window.caminhos[strp].distancia > no.distancia + tamp) {
        window.caminhos[strp] = {
          distancia: no.distancia + tamp,
          percurso: no.percurso.slice()
        }
        window.caminhos[strp].percurso.push(p)
        window.fila.push(p)
      }
    } else {
      window.caminhos[strp] = {
        distancia: no.distancia + tamp,
        percurso: no.percurso.slice()
      }
      window.caminhos[strp].percurso.push(p)
      window.fila.push(p)
    }
  }
}
console.log(`terminou em ${Date.now() - window.t0} milisegundos`)

window.caminhos[window.keyner(window.fim)].percurso.forEach(e => {
  const span = document.createElement('span')
  span.setAttribute('class', 'caminho')
  span.innerHTML = 'x'
  document.getElementById(window.keyner(e)).appendChild(span)
})
*/
window.cavaleiros = [
  {
    nome: 'Seiya',
    cosmos: 1.5
  },
  {
    nome: 'Shiryu',
    cosmos: 1.4
  },
  {
    nome: 'Hyoga',
    cosmos: 1.3
  },
  {
    nome: 'Shun',
    cosmos: 1.2
  },
  {
    nome: 'Ikki',
    cosmos: 1.1
  }
]

window.casas = [
  [window.cavaleiros[0], window.cavaleiros[1]], // casa 0
  [window.cavaleiros[1], window.cavaleiros[2]], // casa 1
  [window.cavaleiros[2], window.cavaleiros[3]], // casa 2
  [window.cavaleiros[3], window.cavaleiros[4]],
  [window.cavaleiros[4], window.cavaleiros[0]],
  [window.cavaleiros[0], window.cavaleiros[1]],
  [window.cavaleiros[1], window.cavaleiros[2]],
  [window.cavaleiros[2], window.cavaleiros[3]],
  [window.cavaleiros[3], window.cavaleiros[4]],
  [window.cavaleiros[4], window.cavaleiros[0]],
  [window.cavaleiros[0], window.cavaleiros[1]],
  [window.cavaleiros[1], window.cavaleiros[2]]
]

window.dificuldadeCasas = [
  50,
  55,
  60,
  70,
  75,
  80,
  85,
  90,
  95,
  100,
  110,
  120
]
function moveCavaleiroRandom (casas) {
  let casaOrigem
  // a origem não pode ser uma casa com apenas 1 cavaleiro
  while (casas[casaOrigem = Math.floor(casas.length * Math.random())].length === 1);
  let cavaleiroOrigem = Math.floor(casas[casaOrigem].length * Math.random())

  let casaDestino
  // o destino não pode ser uma casa que já possui o cavaleiro de origem
  // O destino não pode ter 5 cavaleiros
  while (
    casas[casaDestino = Math.floor(casas.length * Math.random())].find(el => el === casas[casaOrigem][cavaleiroOrigem]) ||
    casas[casaDestino].length === 5);

  console.log(`casas[${casaOrigem}][${cavaleiroOrigem}] --> casas[${casaDestino}]`)

  const origenFiltrada = casas[casaOrigem].filter((el, idx) => idx === cavaleiroOrigem)
  const novoDestino = casas[casaDestino].slice()
  novoDestino.push(casas[casaOrigem][cavaleiroOrigem])

  return casas.map((el, idx) => {
    if (idx === casaOrigem) {
      return origenFiltrada
    } else if (idx === casaDestino) {
      return novoDestino
    } else {
      return el
    }
  })
}
